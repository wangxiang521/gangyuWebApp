<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"content="initial-scale=1, minimum-scale=1, maximum-scale=1,user-scalable=no,minimal-ui"/>
    <meta name="apple-mobile-web-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>购物车</title>
    <script>
        !function(win) {
            function resize() {
                var domWidth = domEle.getBoundingClientRect().width;
                if(domWidth / v > 540){
                    domWidth = 540 * v;
                }
                win.rem = domWidth / 16;
                domEle.style.fontSize = win.rem + "px";
            }
            var v, initial_scale, timeCode, dom = win.document, domEle = dom.documentElement, viewport = dom.querySelector('meta[name="viewport"]'), flexible = dom.querySelector('meta[name="flexible"]');
            if (viewport) {
                //viewport：<meta name="viewport"content="initial-scale=0.5, minimum-scale=0.5, maximum-scale=0.5,user-scalable=no,minimal-ui"/>
                var o = viewport.getAttribute("content").match(/initial\-scale=(["']?)([\d\.]+)\1?/);
                if(o){
                    initial_scale = parseFloat(o[2]);
                    v = parseInt(1 / initial_scale);
                }
            } else {
                if (flexible) {
                    var o = flexible.getAttribute("content").match(/initial\-dpr=(["']?)([\d\.]+)\1?/);
                    if(o){
                        v = parseFloat(o[2]);
                        initial_scale = parseFloat((1 / v).toFixed(2))
                    }
                }
            }
            if (!v && !initial_scale) {
                var n = (win.navigator.appVersion.match(/android/gi), win.navigator.appVersion.match(/iphone/gi));
                v = win.devicePixelRatio;
                v = n ? v >= 3 ? 3 : v >= 2 ? 2 : 1 : 1, initial_scale = 1 / v
            }
            //没有viewport标签的情况下
            if (domEle.setAttribute("data-dpr", v), !viewport) {
                if (viewport = dom.createElement("meta"), viewport.setAttribute("name", "viewport"), viewport.setAttribute("content", "initial-scale=" + initial_scale + ", maximum-scale=" + initial_scale + ", minimum-scale=" + initial_scale + ", user-scalable=no"), domEle.firstElementChild) {
                    domEle.firstElementChild.appendChild(viewport)
                } else {
                    var m = dom.createElement("div");
                    m.appendChild(viewport), dom.write(m.innerHTML)
                }
            }
            win.dpr = v;
            win.addEventListener("resize", function() {
                clearTimeout(timeCode), timeCode = setTimeout(resize, 300)
            }, false);
            win.addEventListener("pageshow", function(b) {
                b.persisted && (clearTimeout(timeCode), timeCode = setTimeout(resize, 300))
            }, false);
            /* 个人觉得没必要完成后就把body的字体设置为12
             "complete" === dom.readyState ? dom.body.style.fontSize = 12 * v + "px" : dom.addEventListener("DOMContentLoaded", function() {
             //dom.body.style.fontSize = 12 * v + "px"
             }, false);
             */
            resize();
        }(window);
    </script>
    <link rel="stylesheet" type="text/css" href="css/common.css" />
    <link rel="stylesheet" type="text/css" href="css/gwc.css" />
</head>
<body>
<div class="mtop">
    <a href="#" onclick="history.go(-1)"></a>
    购物车
    <div class="cleanAll">清空</div>
</div>
<div class="container">
    <div class="content content-container">
        <b class="dx"></b>
        <div class="content-d">
            <span class="name">优碳板</span>
            <span>14*2000*L</span>
            <span>Q345b</span>
            <span>马钢</span>
            <span class="price">￥4800</span>
            <b class="price-count1">4800</b>
        </div>
        <div>
            <span>佛山</span>
            <span>俊杰仓</span>
            <span class="count">10件/23.125吨</span>
        </div>
        <div class="addc-p">
            <div class="addc left">
                <div class="left minus">-</div>
                <div class="right add">+</div>
                <span class="count-num">1</span>
                <b class="count1">4.123</b>
            </div>
            <span class="dw">4.123吨</span>

            <div class="right btn-delete">删除</div>
        </div>
    </div>
    <div class="content content-container">
        <b class="dx"></b>
        <div class="content-d">
            <span class="name">低合金版</span>
            <span>14*2000*L</span>
            <span>Q345b</span>
            <span>马钢</span>
            <span class="price">￥4800</span>
            <b class="price-count1">4800</b>
        </div>
        <div>
            <span>佛山</span>
            <span>俊杰仓</span>
            <span class="count">10件/23.125吨</span>
        </div>
        <div class="addc-p">
            <div class="addc left">
                <div class="left minus">-</div>
                <div class="right add">+</div>
                <span class="count-num">1</span>
                <b class="count1">4.123</b>
            </div>
            <span class="dw">4.123吨</span>

            <div class="right btn-delete">删除</div>
        </div>
    </div>
    <div class="content content-container">
        <b class="dx"></b>
        <div class="content-d">
            <span class="name">低合金版</span>
            <span>14*2000*L</span>
            <span>Q345b</span>
            <span>马钢</span>
            <span class="price">￥4800</span>
            <b class="price-count1">4800</b>
        </div>
        <div>
            <span>佛山</span>
            <span>俊杰仓</span>
            <span class="count">10件/23.125吨</span>
        </div>
        <div class="addc-p">
            <div class="addc left">
                <div class="left minus">-</div>
                <div class="right add">+</div>
                <span class="count-num">1</span>
                <b class="count1">4.123</b>
            </div>
            <span class="dw">4.123吨</span>

            <div class="right btn-delete">删除</div>
        </div>
    </div>
    <div class="content content-container">
        <b class="dx"></b>
        <div class="content-d">
            <span class="name">中合金版</span>
            <span>14*2000*L</span>
            <span>Q345b</span>
            <span>马钢</span>
            <span class="price">￥4800</span>
            <b class="price-count1">4800</b>
        </div>
        <div>
            <span>佛山</span>
            <span>俊杰仓</span>
            <span class="count">10件/23.125吨</span>
        </div>
        <div class="addc-p">
            <div class="addc left">
                <div class="left minus">-</div>
                <div class="right add">+</div>
                <span class="count-num">1</span>
                <b class="count1">4.123</b>
            </div>
            <span class="dw">4.123吨</span>

            <div class="right btn-delete">删除</div>
        </div>
    </div>
    <div class="content content-container">
        <b class="dx"></b>
        <div class="content-d">
            <span class="name">高合金版</span>
            <span>14*2000*L</span>
            <span>Q345b</span>
            <span>马钢</span>
            <span class="price">￥4800</span>
            <b class="price-count1">4800</b>
        </div>
        <div>
            <span>佛山</span>
            <span>俊杰仓</span>
            <span class="count">10件/23.125吨</span>
        </div>
        <div class="addc-p">
            <div class="addc left">
                <div class="left minus">-</div>
                <div class="right add">+</div>
                <span class="count-num">1</span>
                <b class="count1">4.123</b>
            </div>
            <span class="dw">4.123吨</span>

            <div class="right btn-delete">删除</div>
        </div>
    </div>
    <div class="content content-zong">
        <b class="qx"></b>
        <span class="left qx-txt">全选</span>
        <div class="left sum">
            <span>共</span><span class="sum-num">0</span><span>件,</span>
        </div>
        <div class="left weight">
            <span class="weight-num">0</span><span>吨,</span>
        </div>
        <div class="left money">
            <span>合计</span><span class="money-num">0</span><span>元</span>
        </div>

    </div>
    <div class="btn">
        <div class="left btn-left" onclick="javscript:window.location.href=('superMarket.html')">
            继续采购
        </div>
        <div class="right btn-right" onclick="javscript:window.location.href=('View-account.html')">
            马上下单
        </div>
    </div>
    <div class="last-div">
        <span>有疑问请联系交易员</span>
        <span> 张晓燕</span>
        <b></b>
            <span>13600325698</span>
    </div>
</div>


<!--确认删除模块-->
<div class="del-model">
    <div class="content">
        <!--<span class="close">&times;</span>-->
        <h1>是否确认删除？</h1>
        <div class="d-del">删除</div>
        <div class="n-del">取消</div>
    </div>
</div>
</body>
<script src="js/jquery-1.9.1.min.js"></script>
<script>

    $('.add').on('click',function(){
        var b=parseFloat($(this).siblings('.count1').html());
        var a= parseInt($(this).siblings('span').html());
//        console.log(a)
        if(a>=10){return}
        $(this).siblings('span').html(a+1);
        var c=(a+1)* b
        c= c.toFixed(3)
//        console.log(c)
        $(this).parent().siblings('.dw').html(c+'吨')
        var p=$(this).parent().parent().siblings('.content-d').children('.price-count1')
        var p1= parseFloat(p.html())
        p.siblings('.price').html('￥'+p1*(a+1))
        heji()
    })
    $('.minus').on('click',function(){
        var b=parseFloat($(this).siblings('.count1').html());
        var a= parseInt($(this).siblings('span').html());
//        console.log(a);

        if(a==1){return}
        var p=$(this).parent().parent().siblings('.content-d').children('.price-count1');
        var p1= parseFloat(p.html());
        p.siblings('.price').html('￥'+p1*(a-1));
        $(this).siblings('span').html(a-1);
        var c=(a-1)* b;
        c= c.toFixed(3);
//        console.log(c);
        $(this).parent().siblings('.dw').html(c+'吨');
        heji()
    })
    $('.content>.dx').on('click',function(){
//        console.log($(this).hasClass('checked'))
        if($(this).hasClass('checked')){
            $('.qx').removeClass('qx-checked')
//            console.log($(".qx"))
        }
        $(this).toggleClass('checked')
        heji()
        /*var arr=[];
        var count=document.getElementsByClassName('count-num');
        for(var i=0;i<count.length;i++){
          if($(count[i]).parent().parent().siblings('.dx').hasClass('checked')) {
              var txt=$(count[i]).html();
              arr.push(txt)
          }
        }
        console.log(arr)
        for(var i= 0,sum=0;i<arr.length;i++){
            sum+=arr[i]
        }
        console.log(sum)
        var s=$('.sum-num').html()
       $('.sum-num').html(s+sum)*/
    })
  /*全选*/
    $('.qx').on('click',function(){
        $('.qx').toggleClass('qx-checked')
        var dx=document.getElementsByClassName('dx');
        if( $(this).hasClass('qx-checked')){
            for(var i=0;i<dx.length;i++){
                if(!$(dx[i]).hasClass('checked')){
                    $(dx[i]).addClass('checked')
                }
            }
        }else{
            $('.dx').removeClass('checked')
        }

        heji()
    })

    /*合计*/
    function heji(){
        var num=[];
        var weight=[];
        var price=[];
        var content=document.getElementsByClassName('content-container');
        for(var i=0;i<content.length;i++){
            if($(content[i]).children('.dx').hasClass('checked')){
                var num1=$(content[i]).find('.count-num').html();
                num.push(num1)
                var weight1=$(content[i]).find('.dw').html();
                weight.push(weight1);
                var price1=$(content[i]).find('.price').html();
                price.push(price1)
            }
        }
//        console.log(weight)
//        console.log(num)
//        console.log(price)
        for(var i= 0,sum=0;i<num.length;i++){
            sum=sum+parseFloat(num[i])
        }
        for(var i= 0,wum=0;i<weight.length;i++){
            wum=wum+parseFloat(weight[i])
        }
        for(var i= 0,pum=0;i<price.length;i++){
            pum=pum+parseFloat(price[i].split('￥')[1])
        }

//        wum
        $('.sum-num').html(sum*1)
        $('.weight-num').html((wum*1).toFixed(3))
        $('.money-num').html(pum*1)
    }
    /*删除*/
//    $('.btn-delete').on('click',function(){
//        var content=$(this).parent().parent()[0];
//        console.log(content)
//       $('.container')[0].removeChild(content)
//        heji()
//    })
    //    删除确认
    $('.btn-delete').on('click',function(){
        $('.del-model').css('display','block');
        var content=$(this).parent().parent();
        console.log(content);
        $('.d-del').on('click',function(){
            content.remove();
        heji();
            $('.del-model').css('display','none');

        })
        $('.n-del').on('click',function(){
            $('.del-model').css('display','none')
        })
    })


</script>
</html>